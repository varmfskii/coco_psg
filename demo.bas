10 REM ************************
20 REM ****  DEMO PROGRAM  ****
30 REM ** FOR SPEECH/SOUND ****
40 REM **     CARTRIDGE     ***
50 REM ************************
60 REM ************************
70 CLEAR 512
80 X=&HFF00:Y=&HFF7E:Z=&HFF7D
90 DIM P$(8)
110 REM SETUP
130 POKE Z,1:POKEZ,0
140 POKE X+1,52:POKE X+3,63
150 POKE X+35,60
180 REM DEFINE SPEECH STRINGS
200 GOSUB 2890
230 REM LOAD SPEECH STRINGS
250 PRINT "LOADING SPEECH"
260 FOR C=1TO8
270 GOSUB 3360
280 NEXT C
310 REM LOAD SOUNDS
330 PRINT "LOADING SOUND"
340 FOR C=1 TO 6
350 GOSUB 3490
360 NEXT C
390 REM EXECUTE DEMO
410 PRINT "DEMONSTRATING"
430 REM LOAD BASE TIMER
450 GOSUB 3170
460 POKE Y,&H8F
470 GOSUB 3170
480 POKE Y,60
490 GOSUB 3170
520 REM EXEC SPEECH BUFFER 0
540 POKE Y,208
550 GOSUB 3230
560 GOSUB 3030
570 GOSUB 3170
600 REM EXEC SPEECH BUFFER 1
620 POKE Y,209
630 GOSUB 3030
640 GOSUB 3170
670 REM EXEC SPEECH BUFFER 4
690 POKE Y,212
700 GOSUB 3300
710 GOSUB 3030
720 GOSUB 3170
750 REM EXEC SOUND BUFFER 0
770 POKE Y,216
780 GOSUB 3230
790 GOSUB 3100
800 GOSUB 3170
830 REM EXEC SPEECH BUFFER 5
850 POKE Y,213
860 GOSUB 3230
870 GOSUB 3030
880 GOSUB 3170
910 REM EXEC SOUND BUFFER 1
930 POKE Y,217
940 GOSUB 3230
950 GOSUB 3100
960 GOSUB 3170
990 REM EXEC SPEECH BUFFER 2
1010 POKE Y,210
1020 GOSUB 3030
1030 GOSUB 3170
1060 REM EXEC SPEECH BUFFER 4
1080 POKE Y, 212
1090 GOSUB 3230
1100 GOSUB 3030
1110 GOSUB 3170
1140 REM EXEC REG STR BUFFER 3
1160 POKE Y,251
1170 GOSUB 3230
1180 REM GOSUB 3100
1190 GOSUB 3170
1220 REM EXEC REG STR BUFFER 4
1240 POKE Y, 252
1250 GOSUB 3230
1260 REM GOSUB 3100
1270 GOSUB 3170
1300 REM EXEC REG STR BUFFER 3
1320 POKE Y, 251
1330 GOSUB 3230
1340 REM GOSUB 3100
1350 GOSUB 3170
1380 REM EXEC REG STR BUFFER 5
1400 POKE Y,253
1410 GOSUB 3230
1420 REM GOSUB 3100
1430 GOSUB 3170
1460 REM EXEC REG STR BUFFER 3
1480 POKE Y,251
1490 GOSUB 3230
1500 REM GOSUB 3100
1510 GOSUB 3170
1540 REM STOP ALL SOUND
1560 POKE Y,207
1570 GOSUB 3170
1600 REM EXEC SPEECH BUFFER 3
1620 POKE Y,211
1630 GOSUB 3230
1640 GOSUB 3230
1650 GOSUB 3230
1660 GOSUB 3030
1670 GOSUB 3170
1700 REM EXEC SOUND BUFFER 2
1720 POKE Y, 218
1730 GOSUB 3100
1740 GOSUB 3170
1770 REM EXEC SPEECH BUFFER 7
1790 POKE Y,215
1800 GOSUB 3170
1830 REM EXEC REG STR BUFFER 3
1850 POKE Y,251
1860 GOSUB 3230:REM GOSUB 3100
1870 GOSUB 3170
1900 REM EXEC REG STR BUFFER 4
1920 POKE Y,252
1930 GOSUB 3230:REM GOSUB 3100
1940 GOSUB 3170
1970 REM EXEC REG STR BUFFER 3
1990 POKE Y,251
2000 GOSUB 3230:REM GOSUB 3100
2010 GOSUB 3170
2040 REM EXEC REG STR BUFFER 5
2060 POKE Y,253
2070 GOSUB 3230:REM GOSUB 3100
2080 GOSUB 3170
2110 REM EXEC REG STR BUFFER 3
2130 POKE Y,251
2140 GOSUB 3230:REM GOSUB 3100
2150 GOSUB 3170
2180 REM STOP ALL SOUND
2200 POKE Y,207
2210 GOSUB 3170
2240 REM EXEC SPEECH BUFFER 6
2260 POKE Y,214
2290 END
2310 REM TUNE 1
2320 REM COMMAND MODE SOUND
2340 DATA 11,0,214,6,0,0,0,6
2350 DATA 11,1,29,4,11,1,46,4
2360 DATA 11,1,29,4,11,1,13,12
2370 DATA 11,1,29,6,0,0,0,18
2380 DATA 11,0,226,6,0,0,0,6
2390 DATA 11,0,214,6,0,0,0,0
2420 REM TUNE 2
2430 REM COMMAND MODE SOUND
2450 DATA 11,0,214,6,0,0,0,0
2460 DATA 11,0,214,12,0,0,0,0
2470 DATA 11,0,214,12,0,0,0,0
2480 DATA 11,1,13,6,0,0,0,0
2490 DATA 11,0,254,12,0,0,0,0
2500 DATA 11,1,64,6,0,0,0,0
2530 REM GUNSHOT
2540 REM COMMAND MODE NOISE
2550 REM WITH ENVELOPE
2570 DATA 159,15,15,191,15,15
2580 DATA 223,15,15,98,0,14,5
2590 DATA 0,0,0,0
2620 REM C CHORD
2630 REM DIRECT REGISTER SOUND
2650 DATA 0,172,1,1,2,83,3,1
2660 DATA 4,29,5,1,6,0,7,56
2670 DATA 8,9,9,9,10,9,11,0
2680 DATA 12,0,13,0
2710 REM F CHORD
2720 REM DIRECT REGISTER SOUND
2740 DATA 0,172,1,1,2,64,3,1
2750 DATA 4,254,5,0,6,0,7,56
2760 DATA 8,9,9,9,10,9,11,0
2770 DATA 12,0,13,0
2800 REM G CHORD
2810 REM DIRECT REGISTER SOUND
2830 DATA 0,197,1,1,2,125,3,1
2840 DATA 4,29,5,1,6,0,7,56
2850 DATA 8,9,9,9,10,9,11,0
2860 DATA 12,0,13,0
2890 REM STRINGS
2900 REM TEXT-TO-SPEECH
2920 P$(1)="HELLO . . . I AM THE COLOR COMPUTER SOUND AND SPEECH CARTRIDGE."
2930 P$(2)="I CAN NOT ONLY TALK. . . I CAN ALSO PLAY MELODIES."
2940 P$(3)="I CAN PLAY CORDS."
2950 P$(4)="I CAN MAKE SOUND EFFECTS. . . LIKE THIS GUNSHOT."
2960 P$(5)="LIKE THIS."
2970 P$(6)="AND THIS."
2980 P$(7)="I HOPE YOU WILL ENJOY USING ME."
2990 P$(8)="I CAN PLAY CORDS WHILE SPEAKEYNG."
3000 RETURN
3030 REM SPEECH* CHECK
3050 FORQ=1TO800:NEXT Q
3060 IF (PEEK(Y) AND 64) = 0 THEN 3060
3070 RETURN
3100 REM SOUND* CHECK
3120 FORQ=1TO700:NEXT Q
3130 IF (PEEK(Y) AND 32) = 0 THEN 3130
3140 RETURN
3170 REM BUSY* CHECK
3190 IF (PEEK(Y) AND 128) = 0 THEN 3190
3200 RETURN
3230 REM SHORT DELAY
3250 GOSUB 3170
3260 FOR Q = 1 TO 800:NEXT Q
3270 RETURN
3300 REM LONG DELAY
3320 FOR Q=1 TO 6000:NEXT Q
3330 RETURN
3360 REM LOAD A STRING
3380 GOSUB 3170
3390 POKE Y,143+C
3400 FOR I=1 TO LEN(P$(C))
3410 GOSUB 3170
3420 POKE Y, ASC(MID$(P$(C),I,1))
3430 NEXT I
3440 GOSUB 3170
3450 POKE Y,13
3460 RETURN
3490 REM LOAD A SOUND
3510 IF C>2 THEN 3560
3520 K=48
3530 GOSUB 3170
3540 POKE Y,151+C
3550 GOTO 3600
3560 IF C=3 THEN K=17:GOTO 3530
3570 K=28
3580 GOSUB 3170
3590 POKE Y, 183+C
3600 FOR I=1 TO K
3610 READ D
3620 GOSUB 3170
3630 POKE Y,D
3640 NEXT I
3650 GOSUB 3170
3660 POKE Y,255
3670 RETURN
